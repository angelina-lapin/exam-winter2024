import{c as l,d as m}from"./constants-CbZCZHJ1.js";async function d({name:n,email:a,password:t}){try{const e=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:a,password:t})});if(!e.ok){const s=await e.json();throw s.errors&&s.errors.length>0&&s.errors.forEach((r,c)=>{console.error(`Error ${c+1}:`,r.message||r)}),new Error(s.message||"Registration failed")}return await e.json()}catch(o){throw console.error("Error during registration (catch block):",o.message),o}}async function g({email:n,password:a}){try{const t=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:a})});if(!t.ok){const o=await t.json();throw new Error(o.message||"Login failed")}return await t.json()}catch(t){throw console.error("Error during login:",t),t}}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("alert-container"),a=localStorage.getItem("successMessage");if(a&&n){const e=document.createElement("div");e.className="alert alert-success",e.role="alert",e.textContent=a,n.appendChild(e),localStorage.removeItem("successMessage")}const t=document.getElementById("registerForm");t&&t.addEventListener("submit",async e=>{e.preventDefault();const i=document.getElementById("name").value.trim(),s=document.getElementById("email").value.trim(),r=document.getElementById("password").value.trim();try{const c=await d({name:i,email:s,password:r});localStorage.setItem("successMessage","Registration successful! Please log in using your new account."),window.location.href="./login.html"}catch(c){console.error("Registration error:",c),alert(c.message||"Registration failed")}});const o=document.getElementById("loginForm");o&&o.addEventListener("submit",async e=>{e.preventDefault();const i=document.getElementById("email").value.trim(),s=document.getElementById("password").value.trim();try{const r=await g({email:i,password:s});localStorage.setItem("token",r.token),localStorage.setItem("user",JSON.stringify(r)),alert("Login successful!"),window.location.href="/index.html"}catch(r){console.error("Login error:",r),alert(r.message||"Login failed")}})});
